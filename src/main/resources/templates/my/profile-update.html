
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>보디가드 | 프로필 수정</title>
    <link rel="stylesheet" href="/css/style.css"/>
</head>
<body>

<div class="bottom-border-div">
    <div class="index-header wrap">
        <h2>마이페이지</h2>
        <div>
            <a th:href="@{/index}"></a>
        </div>
        <div>
            <a th:href="@{/my/profile}"></a>
        </div>
    </div>
</div>

<div class="my-main wrap">
    <div class="content">
        <form th:action="@{/my/profile-update}" method="post" enctype="multipart/form-data" class="profile-update-form">
            <div class="account">
                <ul>
                    <li>아이디 : <span th:text="${user.id}"></span></li>
                    <li>닉네임 : <input type="text" th:value="${user.nickname}" name="nickname"/></li>

                    <li>프로필 사진 :
                        <div style="margin-top: 8px;">
                            <img id="previewImage"
                                 th:src="${user.imageUrl != null && !#strings.isEmpty(user.imageUrl)} ? ${user.imageUrl} : '/images/default.png'"
                                 alt="프로필 미리보기"
                                 style="width: 100px; height: 100px; object-fit: cover; border-radius: 10px; border: 1px solid #ccc;"/>
                        </div>
                        <input type="file" name="imageFile" accept="image/*" onchange="previewImage(event)" style="margin-top: 8px;"/>
                    </li>

                    <li>성별
                        <select name="gender" th:value="${user.gender}">
                            <option value="남성">남성</option>
                            <option value="여성">여성</option>
                        </select>
                    </li>
                    <li>키 : <input type="number" th:step="0.1" th:value="${user.height}" name="height"/></li>
                    <li>몸무게 : <input type="number" th:step="0.1" th:value="${user.weight}" name="weight"/></li>
                    <li>나이 : <input type="number" th:value="${user.age}" name="age"/></li>
                    <li>목표 : <input type="text" th:value="${user.goal}" name="goal"/></li>
                </ul>
            </div>

            <div>
                <button type="submit">수정하기</button>
            </div>
            <div class="my-main-nav">
                <button onclick="location.href='/my/profile'" class="back-btn">뒤로가기</button>
            </div>
        </form>
    </div>
</div>

<script>
    function previewImage(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function () {
            const output = document.getElementById('previewImage');
            output.src = reader.result;
        };
        reader.readAsDataURL(file);
    }
</script>

</body>
</html>
